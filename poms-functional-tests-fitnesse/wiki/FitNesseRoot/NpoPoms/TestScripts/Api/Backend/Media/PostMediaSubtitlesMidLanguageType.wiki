---
Help: POST /media/subtitles/{mid}/{language}/{type}
Suites: NPOAPI-130, RG
Test
---
!*> Test-specific items
!define bodyClip { {{{
<program xmlns="urn:vpro:media:update:2009" type="CLIP" avType="VIDEO" embeddable="true">
  <broadcaster>NPO</broadcaster>
  <title type="MAIN">Specialisterren !today (yyyyMMddHHmm)</title>
  <title type="SUB">Testsubtitle</title>
  <title type="ORIGINAL">Original title</title>
  <description type="MAIN">Deze clip is aangemaakt door Specialisterren.</description>
  <description type="SHORT">Specialisterren Clip.</description>
  <description type="SUB">Specialisterren Clip.</description>
  <description type="EPISODE">Nieuwe Clip van vandaag.</description>
  <credits/>
  <locations/>
  <scheduleEvents/>
  <images/>
  <segments/>
</program>
}}} }

!define bodySubtitles { {{{
{
  "mid": "$mid",
  "content": {
    "format": "WEBVTT",
    "value": [
      "1
       19:01:06.920 --> 19:01:07.960
       888

       2
       19:01:08.800 --> 19:01:10.200
       Ondertitels van dit object

       3
       19:01:10.200 --> 19:01:12.760
       Soms is lezen beter dan luisteren

       4
       19:01:12.760 --> 19:01:15.800
       En soms is luisteren beter"
    ],
  },
  "type": "CAPTION",
  "owner": "BROADCASTER",
  "workflow": "IGNORE",
  "creationDate": "2020-06-08T06:48:38.836Z",
  "lastModified": "2020-06-08T06:48:38.836Z"
}
}}} }
*!

Post-call based on [[POST /media/{entity} (NPOAPI-94)][<Media.PostMediaEntity]]

|script                                                                             |
|show |post           |${bodyClip}|to|${urlBackendApi}/media/media?owner=BROADCASTER|
|check|response status|202                                                          |
|check|response       |=~/^POMS_NPO_\d{7}$/                                         |
|$mid=|response                                                                     |

|script                                                                                                   |
|set content type|text/vtt                                                                                |
|show            |post           |${bodySubtitles}  |to |${urlBackendApi}/media/subtitles/$mid/nl/CAPTION |
|check           |response status|202                                                                     |
|check           |response       |Subtitles (4 cues, 568 bytes) provisionally accepted for $mid	CAPTION	nl|

|script                                                                  |
|set content type               |application/xml; charset=UTF-8          |
|show                           |delete|${urlBackendApi}/media/media/$mid|
|repeat until response status is|202                                     |
