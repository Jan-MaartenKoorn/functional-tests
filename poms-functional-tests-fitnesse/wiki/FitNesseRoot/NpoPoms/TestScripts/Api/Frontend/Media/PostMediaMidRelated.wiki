---
Help: POST /media/{mid}/related
Suites: NPOAPI-16, RG
Test
---
!*> Test-specific items
!define mid {14Jeugd0845geb}
!define numberOfItems {10}
!define firstBody {!-{}-!}
!define firstBroadcasterAfterFirstPost {NPS}
!define secondBody { {{{
{
  "searches": {
    "broadcasters": [
      {
        "match": "NOT",
        "value": "${firstBroadcasterAfterFirstPost}"
      }
    ]
  }
}
}}} }

|scenario|Post |body                                            |
|post    |@body|to|${urlFrontendApi}/media/${mid}/related?max=10|

|scenario     |Check broadcaster of item number|index         |is not       |broadcaster  |
|$broadcaster=|json path                       |items[@index].result.broadcasters[0].value|
|push fixture                                                                             |
|start        |string fixture                                                             |
|ensure       |value                           |$broadcaster  |differs from |@broadcaster |
|pop fixture                                                                              |
*!
|script                                                                                                                      |
|Post                            |${firstBody}                                                                               |
|set repeat interval to          |10000                                |milliseconds                                         |
|repeat at most                  |30                                   |times                                                |
|repeat until json path          |items[0].result.broadcasters[0].value|is                 |${firstBroadcasterAfterFirstPost}|
|$repeatCount=                   |repeat count                                                                               |
|$timeSpentRepeating=            |time spent repeating                                                                       |
|$timeSpentRepeating=            |format timestamp                     |$timeSpentRepeating|as             |m:ss             |
|check                           |json path                            |total              |${numberOfItems}                 |
|check                           |json path count                      |items.*            |${numberOfItems}                 |
|Post                            |${secondBody}                                                                              |
|Check broadcaster of item number|0                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|1                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|2                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|3                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|4                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|5                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|6                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|7                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|8                                    |is not             |${firstBroadcasterAfterFirstPost}|
|Check broadcaster of item number|9                                    |is not             |${firstBroadcasterAfterFirstPost}|
