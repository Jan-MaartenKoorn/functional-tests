---
Test
---
!include -c <Zoeken.Variabelen

!*> Lokale variabelen

!define avtype {Video}
!define persoon {Paul Koster}

!define datumEnPersoon1 {!-uitzend-/sorteerdatum:
vanaf: $vorigeMaand
tot en met:-!}

!define datumEnPersoon2 {aangemaakt door:}
*!

|script                                                                                                                                                                             |
|Open Npo poms website                                                                                                                                                              |
|Npo poms Inlogscherm Log in met standaard-gebruiker                                                                                                                                |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten1                                                                                                   |
|click                                                     |Datum & Persoon                                                                                                         |
|click                                                     |Afgelopen maand                                                                                                         |
|$vorigeMaand=                                             |decrease today with months            |1                       |with format    |dd-MM-yyyy              |with local |nl |
|Npo poms Zoeken Check tekstveld                           |van:                                  |heeft waarde            |$vorigeMaand                                            |
|Npo poms Zoeken Check tekstveld                           |t/m                                   |heeft waarde            |!today (dd-MM-yyyy)                                     |
|click                                                     |Zoek                                                                                                                    |
|Npo poms Zoeken Check optie                               |${datumEnPersoon1} !today (dd-MM-yyyy)|geselecteerd in dropdown|Datum & Persoon                                         |
|wait for visible                                          |Gezocht naar: uitzend-/sorteerdatum: vanaf $vorigeMaand tot en met !today (dd-MM-yyyy)                                  |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten2                                                                                                   |
|ensure                                                    |value                                 |$aantalZoekresultaten2  |is smaller than|$aantalZoekresultaten1                  |
|Npo poms Zoeken Sla hoofdtitel van eerste object op in var|titelVanEersteObject                                                                                                    |
|Npo poms Zoeken Sla type van eerste object op in var      |typeVanEersteObject                                                                                                     |
|Npo poms Zoeken Dubbelklik op hoofdtitel van eerste object                                                                                                                         |
|Npo poms Hoofdscherm Wacht tot tabblad                    |$titelVanEersteObject                 |geopend                                                                          |
|Npo poms Hoofdscherm Check titel van laatste tab          |$titelVanEersteObject                                                                                                   |
|Npo poms Hoofdscherm Check subtitel van laatste tab       |$typeVanEersteObject                                                                                                    |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                             |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                             |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten1                                                                                                   |
|click                                                     |Datum & Persoon                                                                                                         |
|click                                                     |Aangemaakt door                                                                                                         |
|Npo poms Zoeken Selecteer persoon                         |${persoon}                                                                                                              |
|click                                                     |Zoek                                                                                                                    |
|Npo poms Zoeken Check optie                               |${datumEnPersoon2}                    |is                      |${persoon}     |geselecteerd in dropdown|Datum & Persoon|
|wait for visible                                          |Gezocht naar: gemaakt door: ${persoon}                                                                                  |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten2                                                                                                   |
|ensure                                                    |value                                 |$aantalZoekresultaten2  |is smaller than|$aantalZoekresultaten1                  |
|Npo poms Zoeken Sla hoofdtitel van eerste object op in var|titelVanEersteObject                                                                                                    |
|Npo poms Zoeken Sla type van eerste object op in var      |typeVanEersteObject                                                                                                     |
|Npo poms Zoeken Dubbelklik op hoofdtitel van eerste object                                                                                                                         |
|Npo poms Hoofdscherm Wacht tot tabblad                    |$titelVanEersteObject                 |geopend                                                                          |
|Npo poms Hoofdscherm Check titel van laatste tab          |$titelVanEersteObject                                                                                                   |
|Npo poms Hoofdscherm Check subtitel van laatste tab       |$typeVanEersteObject                                                                                                    |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                             |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                             |
|Npo poms Hoofdscherm Log uit                                                                                                                                                       |
