---
Suites: RG
Test
---
!include -c <Zoeken.Variabelen

!*> Lokale variabelen

!define avtype {Video}
!define persoon {Paul Koster}

!define datumEnPersoon1 {!-uitzend-/sorteerdatum:
vanaf: $vorigeMaand
tot en met:-!}

!define datumEnPersoon2 {aangemaakt door:}

!define datumvandaag {!today (dd-MM-yyyy)}
*!

!*> Lokale scenario's

|scenario|Controleer weergegeven datumrange voor zoeken _|begin, eind                                                                                                   |
|ensure  |is visible on page                             |xpath=//span[normalize-space(.)='uitzend-/sorteerdatum:']/following::a[normalize-space(.)='vanaf: @begin']    |
|ensure  |is visible on page                             |xpath=//span[normalize-space(.)='uitzend-/sorteerdatum:']/following::a[normalize-space(.)='tot en met: @eind']|
*!

|script                                                                                                                                                                                         |
|Open Npo poms website                                                                                                                                                                          |
|Npo poms Inlogscherm Log in met standaard-gebruiker                                                                                                                                            |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten1                                                                                                               |
|click                                                     |Datum & Persoon                                                                                                                     |
|click                                                     |Afgelopen maand                                                                                                                     |
|$vorigeMaand=                                             |decrease today with months |1                                     |with format             |dd-MM-yyyy              |with local |nl |
|Npo poms Zoeken Check tekstveld                           |van:                       |heeft waarde                          |$vorigeMaand                                                     |
|Npo poms Zoeken Check tekstveld                           |t/m                        |heeft waarde                          |${datumvandaag}                                                  |
|click                                                     |Zoek                                                                                                                                |
|Controleer weergegeven datumrange voor zoeken;            |$vorigeMaand               |${datumvandaag}                       |                                                                 |
|wait for visible                                          |Gezocht naar: uitzend-/sorteerdatum: vanaf $vorigeMaand tot en met ${datumvandaag}                                                  |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten2                                                                                                               |
|ensure                                                    |value                      |$aantalZoekresultaten2                |is smaller than         |$aantalZoekresultaten1                  |
|Npo poms Zoeken Sla hoofdtitel van eerste object op in var|titelVanEersteObject                                                                                                                |
|Npo poms Zoeken Sla type van eerste object op in var      |typeVanEersteObject                                                                                                                 |
|Npo poms Zoeken Dubbelklik op hoofdtitel van eerste object                                                                                                                                     |
|Npo poms Hoofdscherm Wacht tot tabblad                    |$titelVanEersteObject      |geopend                                                                                                 |
|Npo poms Hoofdscherm Check titel van laatste tab          |$titelVanEersteObject                                                                                                               |
|Npo poms Hoofdscherm Check subtitel van laatste tab       |$typeVanEersteObject                                                                                                                |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                                         |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                                         |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten1                                                                                                               |
|click                                                     |Datum & Persoon                                                                                                                     |
|click                                                     |Aangemaakt door                                                                                                                     |
|Npo poms Zoeken Selecteer persoon                         |${persoon}                                                                                                                          |
|click                                                     |Zoek                                                                                                                                |
|Npo poms Zoeken Check optie                               |${datumEnPersoon2}         |is                                    |${persoon}              |geselecteerd in dropdown|Datum & Persoon|
|wait for visible                                          |Gezocht naar: gemaakt door: ${persoon}                                                                                              |
|Npo poms Zoeken Sla aantal zoekresultaten op in var       |aantalZoekresultaten2                                                                                                               |
|ensure                                                    |value                      |$aantalZoekresultaten2                |is smaller than         |$aantalZoekresultaten1                  |
|Npo poms Zoeken Sla hoofdtitel van eerste object op in var|titelVanEersteObject                                                                                                                |
|Npo poms Zoeken Sla type van eerste object op in var      |typeVanEersteObject                                                                                                                 |
|Npo poms Zoeken Dubbelklik op hoofdtitel van eerste object                                                                                                                                     |
|Npo poms Hoofdscherm Wacht tot tabblad                    |$titelVanEersteObject      |geopend                                                                                                 |
|Npo poms Hoofdscherm Check titel van laatste tab          |$titelVanEersteObject                                                                                                               |
|Npo poms Hoofdscherm Check subtitel van laatste tab       |$typeVanEersteObject                                                                                                                |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                                         |
|Npo poms Hoofdscherm Sluit laatste tab                                                                                                                                                         |
|Npo poms Hoofdscherm Log uit                                                                                                                                                                   |
